<tool id="place_fossils" name="place_fossils" version="1.0.0" force_history_refresh='True'>
    <description> Maximum Likelihood Fossil Placement on Molecular Phylogeny </description>
    <requirements>
        <requirement type="package">raxml</requirement>
    </requirements>
    <command interpreter="bash">
        place_fossil_ml.sh $data_file $tree > $log 2>&amp;1
    </command>
    <inputs>
        <param format="phylip" name="data_file" type="data" label="Raxml Binary Morphology Matrix" help=""/>
	<param format="newick" name="tree" type="data" label="Molecular Tree" optional="true" help=""/>
    </inputs>
    <outputs>
	<data format="txt" name="log" label="${tool.name} Screen Output on ${on_string}" />
        <data format="txt" name="wts" label="${tool.name} Classification ${on_string}" from_work_dir="RAxML_classification.fossil_weights" />
        <data format="txt" name="weights" label="${tool.name} Site-weights ${on_string}" from_work_dir="RAxML_weights.galaxy" />
        <data format="txt" name="outtree" label="${tool.name} Site-weights ${on_string}" from_work_dir="RAxML_labelledTree.fossil_weights" />
    </outputs>
    <help>
**What it does**

This tool implements a Maximum Likelihood (ML) fossil placement algorithm developed by Berger and Stamatakis 2009. 

------

**Inputs**

1. Input file of morphological data in raxml (phylipE) format. In Osiris, this can be generated by exporting a MorphoBank (www.morphobank.org) dataset into TNT format, then using TNT2PHYTAB, followed by phylocatenator to change the data to raxml format.
2. A molecular phylogeny in nexus format, for example the result of a RAxML analysis.

------

**Outputs**

RAxML writes the resulting tree file in newick text format, which can be viewed in Osiris with TreeVector (of the mothur package). In addition, if bootstrapping was selected, the individual bootstrap trees and the ML tree with support are written as separate newick files.

-------    

**Additional Information**

This method assumes a molecular phylogeny for a set of extant taxa, and then generates weights for each morphological character based on congruence with the molecular phylogeny.  Next, the method attaches the fossils to every possible branch of the molecular tree, and in each case calculates the likelihood of observing the weighted morphological data.  The placement of each fossil in the molecular tree is the placement with the maximum likelihood estimate.  

raxml Home Page:
http://www.exelixis-lab.org/software.html
   
-------    

**Citations**   

This tool is part of the Osiris Phylogenetics Tool Package for Galaxy. If you make extensive use of this tool in a publication, please consider citing the following.

Current Osiris Citation is here

http://osiris-phylogenetics.blogspot.com/2012/10/citation.html

Additional Citations for this tool

Berger and Stamatakis (2010). Accuracy of morphology-based phylogenetic fossil placement under 
maximum likelihood. http://sco.h-its.org/exelixis/pubs/Exelixis-RRDR-2009-1.pdf

Stamatakis, A. (2006). RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models. Bioinformatics.
http://bioinformatics.oxfordjournals.org/content/22/21/2688.short

Todd H. Oakley, Joanna M. Wolfe, Annie R. Lindgren, and Alexander K. Zaharoff (2012). Phylotranscriptomics to Bring the Understudied into the Fold: Monophyletic Ostracoda, Fossil Placement, and Pancrustacean Phylogeny Mol Biol Evol doi:10.1093/molbev/mss216 

</help>
</tool>
